version: '3'
#  docker-compose down --volumes

services:

  postgres-customer: &customer_db
    image: postgres:latest
    container_name: postgres-customer
    volumes:
      - ./customer/migrations/ddl.init.sql:/docker-entrypoint-initdb.d/init.sql
    env_file:
      - build/docker/customer/dev.customer.database.env
    ports:
      - "5555:5432/tcp"

  postgres-ticket:
    image: postgres:latest
    container_name: postgres-ticket
    env_file:
      - build/docker/ticket/dev.ticket.database.env
    volumes:
      - ./ticket/migrations/ddl.init.sql:/docker-entrypoint-initdb.d/init.sql
    ports:
      - "5556:5432/tcp"

  postgres-photo:
    image: postgres:latest
    container_name: postgres-photo
    env_file:
      - build/docker/photo/dev.photo.database.env
    volumes:
      - ./photo/migrations/ddl.init.sql:/docker-entrypoint-initdb.d/init.sql
    ports:
      - "5557:5432/tcp"

#  api-service:
##    image: ticket-api-service:latest
#    container_name: api-service
#    build:
#      context: .
#      dockerfile: ./build/docker/api-service/Dockerfile
#    ports:
#      - "12300:12300/tcp"


  ticket-app:
#    image: ticket-service-server:latest
    container_name: ticket-app
    build:
      context: .
      dockerfile: ./build/docker/ticket/Dockerfile
    ports:
      - "8081:8081/tcp"

#  postgres-test:
#    <<: *customer_db
#    container_name: postgres-test
#    ports:
#      - "5558:5432/tcp"
